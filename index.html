<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebView Security Test</title>
    <style>
        body { font-family: Arial, sans-serif; }
        pre { background: #f4f4f4; padding: 10px; border-radius: 5px; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>WebView Security Test</h1>
    <h3>Results:</h3>
    <pre id="results">Running tests...</pre>
    
    <script>
        (async function() {
            let results = [];

            // 1. Test Camera Access & UI Spoofing Attempt
            try {
                setTimeout(() => {
                    let fakeUI = document.createElement("div");
                    fakeUI.style.position = "absolute";
                    fakeUI.style.top = "50px";
                    fakeUI.style.left = "50px";
                    fakeUI.style.background = "rgba(0, 0, 0, 0.8)";
                    fakeUI.style.color = "white";
                    fakeUI.style.padding = "20px";
                    fakeUI.style.zIndex = "9999";
                    fakeUI.innerHTML = "⚠️ Fake Camera Permission Request<br>Click Allow to Continue";
                    document.body.appendChild(fakeUI);
                    setTimeout(() => document.body.removeChild(fakeUI), 5000);
                }, 1000);

                await navigator.mediaDevices.getUserMedia({ video: true });
                results.push("❌ Camera access allowed without explicit user interaction!");
            } catch (e) {
                results.push("✅ Camera access requires user permission.");
            }

            // 2. Clickjacking & Overlay Test
            try {
                let overlay = document.createElement("iframe");
                overlay.style.position = "absolute";
                overlay.style.top = "0";
                overlay.style.left = "0";
                overlay.style.width = "100vw";
                overlay.style.height = "100vh";
                overlay.style.opacity = "0.1";
                overlay.src = "https://example.com";
                document.body.appendChild(overlay);
                results.push("❌ Overlay clickjacking test: an invisible iframe was placed over the screen.");
                setTimeout(() => document.body.removeChild(overlay), 5000);
            } catch (e) {
                results.push("✅ Clickjacking protections are working.");
            }

            // 3. Cross-Origin Camera Request Test (iframe attempting camera access)
            try {
                let iframe = document.createElement("iframe");
                iframe.src = "https://example.com";
                document.body.appendChild(iframe);
                iframe.onload = () => {
                    try {
                        iframe.contentWindow.navigator.mediaDevices.getUserMedia({ video: true })
                            .then(() => results.push("❌ Cross-origin camera request succeeded! Possible security misconfiguration."))
                            .catch(() => results.push("✅ Cross-origin camera request blocked as expected."));
                    } catch (e) {
                        results.push("✅ Cross-origin camera request not allowed.");
                    }
                    document.body.removeChild(iframe);
                };
            } catch (e) {
                results.push("✅ Cross-origin camera test could not be executed.");
            }

            function displayResults() {
                document.getElementById("results").textContent = results.join("\n");
            }

            displayResults();
        })();
    </script>
</body>
</html>
